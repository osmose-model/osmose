Spatial variablity
========================

Another feature that is implemented in the new fisheries implementation is the possibility to define spatial variability in the fishing effort (:math:`Z_k(x, y, t)` factor in equation 
:eq:`eqn_fsel`).



The spatial variability is managed in the same way as map fishing movements.

A fishing map must be associated with a fisherie index. This is done by setting the 
:samp:`fisheries.fishmap.find.fmapX` parameter, which have values ranging from 0 to :math:`N_{fisheries}-1`.

The user can also provide the years at which the given map is applied (
:samp:`fisheries.fishmap.year.min.fmapX` and
:samp:`fisheries.fishmap.year.max.fmapX` parameters). By default, the start and end simualtion years are used.

The user must also provide the season at which the fishing map is used 
(:samp:`fisheries.fishmap.season.fmapX` parameters).

.. note::

    If a map is missing (at a given year or during a given season), it is considered that the fisherie is deactivated.

Finally, the user must provide the CSV file containing the spatial factors (:samp:`fisheries.fishmap.file.fmapX`).

.. note::

    The model automatically normalize the fishing efforts so that their surface weighted means is :math:`1`.

    Let's call :math:`M` the weighted mean of the provided factors:

    .. math ::
        M = \frac{\sum_{k=1}^{N_{cell}} S_k f_k}{\sum_{k=1}^{N_{cell}} S_k}

    with :math:`N_{cell}` the number of cells within the fisherie area, :math:`S_k` the cell surface and 
    :math:`f_k` the provided spatial fishing factor.

    The new cell factors will be :math:`f_{k_{new}} = \frac{f_k}{M}`

    For instance, if a fishing area contains 6 cells, with spatial factors of :samp:`[1,1,1,2,2]`, the 
    new factors will be :samp:`[0.71, 0.71, 0.71, 1.43]`.

    If the factors are :samp:`[1,1,1,0,0]` (0 if a MPA overlaps with the fishing area for instance), the new
    factors will become :samp:`[1.67,  1.67, 1.67, 0, 0]`, which can be viewed as a uniform redistribution of the fishing effort.
