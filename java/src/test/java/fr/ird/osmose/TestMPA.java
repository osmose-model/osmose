package fr.ird.osmose;

import java.io.IOException;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.HashMap;
import java.util.logging.Level;

import org.junit.jupiter.api.BeforeAll;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.TestInstance;

import static org.junit.jupiter.api.Assertions.assertArrayEquals;

import fr.ird.osmose.process.mortality.FishingMortality;
import ucar.ma2.InvalidRangeException;

@TestInstance(TestInstance.Lifecycle.PER_CLASS)
public class TestMPA {

    private Configuration cfg;
    FishingMortality mortalityFullMpa;
    FishingMortality mortalityPartialMpa;
    FishingMortality mortalityPartialMpaVariableF;
    FishingMortality mortalityPartialMpaVariableFWithZeros;
    FishingMortality mortalityRicardoTest;

    private final int nY = 22;
    private final int nX = 45;
    private final float PRECISION = 0.00001f;

    /** Prepare the input data for the test. */
    @BeforeAll
    public void prepareData() throws Exception {

        Osmose osmose = Osmose.getInstance();
        osmose.getLogger().setLevel(Level.SEVERE);
        String configurationFile = this.getClass().getClassLoader().getResource("osmose-eec/eec_all-parameters.csv")
                .getFile();

        // Adding HashMap to overwrite default setting
        HashMap<String, String> cmd = new HashMap<>();

        // define MPA
        cmd.put("mpa.start.year.mpa0", "0");
        cmd.put("mpa.end.year.mpa0", "1");
        Path inputPath = Paths.get(this.getClass().getClassLoader().getResource("osmose-eec").getPath());
        String mpaFileName = inputPath.resolve("mpa").resolve("full_mpa.csv").toString();
        cmd.put("mpa.file.mpa0", mpaFileName);

        // deactivate new fisheries and use old ones instead
        cmd.put("fisheries.enabled", "false");
        cmd.put("mortality.fishing.rate.sp0", "0.07");
        cmd.put("mortality.fishing.rate.sp1", "0.07");
        cmd.put("mortality.fishing.rate.sp2", "0.07");
        cmd.put("mortality.fishing.rate.sp3", "0.07");
        cmd.put("mortality.fishing.rate.sp4", "0.07");
        cmd.put("mortality.fishing.rate.sp5", "0.07");
        cmd.put("mortality.fishing.rate.sp6", "0.07");
        cmd.put("mortality.fishing.rate.sp7", "0.07");
        cmd.put("mortality.fishing.rate.sp8", "0.07");
        cmd.put("mortality.fishing.rate.sp9", "0.07");
        cmd.put("mortality.fishing.rate.sp10", "0.07");
        cmd.put("mortality.fishing.rate.sp11", "0.07");
        cmd.put("mortality.fishing.rate.sp12", "0.07");
        cmd.put("mortality.fishing.rate.sp13", "0.07");

        // Test the standard configuration
        this.mortalityFullMpa = this.createMortality(configurationFile, cmd);

        // Test with partial MPA
        mpaFileName = inputPath.resolve("mpa").resolve("partial_mpa.csv").toString();
        cmd.put("mpa.file.mpa0", mpaFileName);
        this.mortalityPartialMpa = this.createMortality(configurationFile, cmd);

        // Test with Partial MPA and variable Fishing effort.
        String fishingEffortFileName = inputPath.resolve("mpa").resolve("rate_map1.csv").toString();
        cmd.put("mortality.fishing.spatial.distrib.file.sp0", fishingEffortFileName);
        this.mortalityPartialMpaVariableF = this.createMortality(configurationFile, cmd);

        // Test with Partial MPA and variable Fishing effort.
        fishingEffortFileName = inputPath.resolve("mpa").resolve("rate_map2.csv").toString();
        cmd.put("mortality.fishing.spatial.distrib.file.sp0", fishingEffortFileName);
        this.mortalityPartialMpaVariableFWithZeros = this.createMortality(configurationFile, cmd);

        // This is Ricardo's test request.
        fishingEffortFileName = inputPath.resolve("mpa").resolve("rate_map3.csv").toString();
        cmd.put("mortality.fishing.spatial.distrib.file.sp0", fishingEffortFileName);
        mpaFileName = inputPath.resolve("mpa").resolve("mpa_map3.csv").toString();
        cmd.put("mpa.file.mpa0", mpaFileName);
        this.mortalityRicardoTest = this.createMortality(configurationFile, cmd);

    }

    public FishingMortality createMortality(String configurationFile, HashMap<String, String> cmd) throws IOException, InvalidRangeException {

        Osmose osmose = Osmose.getInstance();
        osmose.getLogger().setLevel(Level.SEVERE);

        osmose.readConfiguration(configurationFile, cmd);
        cfg = osmose.getConfiguration();
        cfg.init();
        osmose.initSimulation();
        FishingMortality mortality = new FishingMortality(0);
        mortality.init();
        mortality.setMPA();

        return mortality;

    }

    @Test
    public void TestFullMpa() {

        float[] expected = new float[] { -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, 0.0f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 1.364985163204748f,
                -999.0f, -999.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                -999.0f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f,
                1.364985163204748f, 1.364985163204748f, 1.364985163204748f, 1.364985163204748f };

        float[] actual = this.buildActualArray(mortalityFullMpa);

        assertArrayEquals(expected, actual, PRECISION);

    }

    @Test
    public void TestPartialMpa() {

        float[] expected = new float[] { -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f, 0.34751952f,
                0.34751952f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f,
                0.34751952f, 0.34751952f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.8108789f, 0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.8108789f, 0.8108789f, 0.8108789f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.34751952f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.8108789f, 0.8108789f, 0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f,
                0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f,
                0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f,
                0.34751952f, 0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f, 0.34751952f,
                0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f,
                0.34751952f, 0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f,
                0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f,
                0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f,
                0.8108789f, 0.8108789f, 0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f,
                0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f, 0.34751952f,
                0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 0.8108789f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.8108789f, 0.8108789f, 0.8108789f,
                0.8108789f, 0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.34751952f, 0.8108789f,
                -999.0f, -999.0f, -999.0f, 0.8108789f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.8108789f, 0.8108789f, 0.8108789f, 1.1583984f, -999.0f, -999.0f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f,
                1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f, 1.1583984f };

        float[] actual = this.buildActualArray(mortalityPartialMpa);

        assertArrayEquals(expected, actual, PRECISION);

    }

    @Test
    public void TestPartialMpaVariableF() {

        float[] actual = this.buildActualArray(this.mortalityPartialMpaVariableF);

        float[] expected = new float[] { -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f,
                0.4334171f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.4334171f, 0.4334171f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.0113066f,
                1.0113066f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 1.0113066f, 1.0113066f, 1.0113066f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                0.72236186f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.4334171f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f,
                0.4334171f, 0.4334171f, 0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f, 0.4334171f,
                0.4334171f, 0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f, 0.4334171f,
                0.4334171f, 0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f,
                0.4334171f, 0.4334171f, 0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 1.0113066f, 1.0113066f, 1.0113066f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f,
                0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f,
                0.4334171f, 0.4334171f, 0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 0.4334171f, 1.0113066f,
                -999.0f, -999.0f, -999.0f, 1.0113066f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.4447237f, -999.0f, -999.0f, 1.4447237f, 1.4447237f, 1.4447237f,
                1.4447237f, 1.4447237f, 1.4447237f, 1.4447237f, 0.72236186f, 0.72236186f, -999.0f, 0.72236186f,
                0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 0.72236186f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.72236186f, 0.72236186f, 0.72236186f,
                0.72236186f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 1.0113066f, 1.0113066f, 1.0113066f,
                1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f, 1.0113066f };

        assertArrayEquals(expected, actual, PRECISION);

    }

    @Test
    public void TestPartialMpaVariableFWithZeros() {

        float[] actual = this.buildActualArray(this.mortalityPartialMpaVariableFWithZeros);

        float[] expected = new float[] { -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f, 0.39977357f,
                0.39977357f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f,
                0.39977357f, 0.39977357f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.93280494f, 0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f,
                0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f,
                0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f, 0.39977357f,
                0.39977357f, 0.39977357f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f,
                0.39977357f, 0.39977357f, 0.39977357f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.93280494f,
                0.93280494f, 0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f,
                0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.93280494f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f, 0.39977357f,
                0.39977357f, 0.39977357f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.39977357f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.39977357f, 0.39977357f,
                0.39977357f, 0.39977357f, 0.39977357f, 0.93280494f, -999.0f, -999.0f, -999.0f, 0.93280494f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                0.93280494f, 0.93280494f, 0.93280494f, 1.3325785f, -999.0f, -999.0f, 1.3325785f, 1.3325785f, 1.3325785f,
                1.3325785f, 1.3325785f, 1.3325785f, 1.3325785f, 0.0f, 0.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f,
                0.0f, 0.0f, 0.0f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.93280494f,
                0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f, 0.93280494f,
                0.93280494f, 0.93280494f };

        assertArrayEquals(expected, actual, PRECISION);

    }

    @Test
    public void TestRicardoMPA() {

        float[] actual = this.buildActualArray(this.mortalityRicardoTest);

        float[] expected = new float[] { -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 0.6967058f, 0.6967058f, 0.6967058f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f,
                0.8708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.8708823f,
                0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, 2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f,
                0.6967058f, 0.6967058f, 0.6967058f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f,
                1.7417645f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 0.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 2.6126468f,
                2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.8708823f,
                0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 2.6126468f, 2.6126468f, 2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.6967058f, 0.6967058f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f,
                1.7417645f, 1.7417645f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f, 2.6126468f, 2.6126468f, 2.6126468f,
                2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.8708823f, 0.8708823f,
                0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f,
                0.0f, 2.6126468f, 2.6126468f, 2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.6967058f, 0.6967058f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f,
                2.6126468f, 2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.6967058f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f,
                0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f, 2.6126468f,
                2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f, 2.6126468f,
                2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f, 2.6126468f,
                2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f, 2.6126468f,
                2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f, 2.6126468f,
                2.6126468f, 2.6126468f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f,
                0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.0f, 0.0f, 0.0f, 0.0f, 0.0f, 2.6126468f, -999.0f, -999.0f,
                -999.0f, 2.6126468f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.6967058f, 0.8708823f, 0.8708823f,
                0.8708823f, 0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f, 0.08708823f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 2.6126468f, 2.6126468f,
                2.6126468f, 0.6967058f, -999.0f, -999.0f, 0.6967058f, 0.6967058f, 0.8708823f, 0.8708823f, 0.8708823f,
                0.8708823f, 0.8708823f, 1.7417645f, 1.7417645f, -999.0f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f,
                1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f,
                0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, 1.7417645f, 1.7417645f, 1.7417645f, 1.7417645f, 0.08708823f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f,
                0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f,
                0.08708823f, 0.08708823f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, -999.0f,
                -999.0f, -999.0f, -999.0f, -999.0f, -999.0f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f,
                0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f, 0.08708823f };

                assertArrayEquals(expected, actual, PRECISION);

    }


    /** Build the actual 1D array based on the fishing mortality object. */
    private float[] buildActualArray(FishingMortality mortality) {

        float[] actual = new float[nY * nX];

        int cpt = 0;
        for (int j = 0; j < nY; j++) {
            for (int i = 0; i < nX; i++) {
                Cell cell = cfg.getGrid().getCell(i, j);
                cpt = j * nX + i;
                if (cell.isLand()) {
                    actual[cpt] = -999.f;
                } else {
                    actual[cpt] = mortality.getFactor(0, cell);
                }
            }
        }

        return actual;

    }

}
